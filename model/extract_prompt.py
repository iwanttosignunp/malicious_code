EXTRACT_CODE_SYSTEM_PROMPT = """
请完成以下任务：
1. 任务目标：从提供的文本中提取所有**不同的高级语言代码片段**；
2. 代码片段定义：连续的代码行即视为一个独立的代码片段；两段代码之间有语言文字（不包括注释）则视为不同的代码片段；
3. 提取规则：
   - 严格保留代码片段的原始字符（包括特殊符号、大小写、笔误、注释、路径/IP/哈希等），不做任何修改、格式化、增删；
   - 若文本中有多个代码片段，每个片段单独成行，片段之间用分割行“&&&”分隔；
   - 仅输出提取的代码片段，不添加任何解释、说明、序号或额外文字；
   - 提取的代码一定要完整，不要提取汇编代码，只用提取代码就行了；
   - 若文本中无代码片段，输出“未提取到代码片段”。
"""

EXTRACT_CODE_USER_PROMPT = """
需要处理的文本：
{TEXT} 
"""

EXTRACT_MALICIOUS_SYSTEM_PROMPT = """
你是网络安全领域的APT攻击溯源专家，现在需要完成以下核心任务：

### 任务背景
我将给你代码片段和文本上下文，请你根据文本上下文提供的信息仔细分析代码片段。
你需要从代码片段中提取**具备实际恶意行为的代码行**（仅提取触发攻击/危害行为的核心行），只精准提取恶意代码行，不要保留多余内容。
如果你输出的两个恶意代码行不是连续的两行代码，则认为这两个恶意代码行是分散的，均需提取，并使用<SEPARATOR>分隔符分隔这两段代码。
如果两个恶意代码行是连续的，中间没有其他代码，则不需要用<SEPARATOR>分隔符分隔。

### 核心规则（必须严格遵守）
1. 恶意代码判定标准：
   - 根据文档的介绍，该行代码直接产生恶意行为；
2. 提取粒度：
   - 只需要提取我给你的代码片段中的恶意代码行，在文本上下文但是不在代码片段中的代码不进行提取；
   - 仅提取代码行本身，不提取代码的注释；
   - 若代码块中包含“恶意行+正常行”混合，仅拆分提取其中的恶意行；
   - 保留代码原始字符（包括特殊符号如|、&、;、Base64编码串、IP/域名、哈希值等），不做任何修改或格式化；
4. 输出要求：
   - 两段分散的恶意代码行之间一定要使用"<SEPARATOR>"分隔，连续的恶意代码行则不需要；
   - 若有恶意代码，输出结果仅包含提取的恶意代码行，不用说明，不要输出其他任何内容；
   - 若报告中无任何符合要求的恶意代码行，输出“未提取到恶意代码行”。
"""

EXTRACT_MALICIOUS_USER_PROMPT = """
### 文本上下文
{TEXT}

### 代码片段
{CODE}
###
代码片段中的恶意代码是（不要输出解释/理由/原因）：
"""

MODIFIED_PROMPT = """
请处理以下代码片段，严格遵循以下规则：
1. 核心保留：除注释和明显错误外，代码的原始字符（包括特殊符号如|、&、;、数字、变量名、函数调用、运算符、括号内内容、路径/IP/哈希等）必须完全保留，不得修改、格式化、增删任何非错误/非注释内容；
2. 注释清理：删除所有注释（包括行内//注释、/* */块注释、代码后标注的// 函数说明等），仅保留代码本体；
3. 错误修正：仅修正代码中**明显的、无歧义的语法错误**，具体包括：
   - 中文符号替换为对应英文符号（如中文括号（）→英文()、中文分号；→英文;、中文引号“”→英文""等）；
   - 明显的笔误（如viθ→v10、vi2→v12、fastca11→fastcall、--int64→_int64、OxF2→0xF2等数字/字母输入错误）；
4. 格式修正：如果代码被'''\n \n'''包含，则去掉'''\n \n'''；
5. 输出要求：仅输出处理后的代码，不添加任何说明、解释、格式标注，也不修改代码的行结构/换行符（原换行保留，原单行仍单行）；如果没有代码（公钥、密钥、汇编不属于代码），请只输出“未提取到代码片段”。

需要处理的代码：
{CODE}
"""

DESCRIBE_MALICIOUS_CODE_PROMPT = """
请根据以下提供的文本上下文和恶意代码片段，为该恶意代码生成一段详细的描述。

输入信息：
1. 文本上下文：
{TEXT}

2. 恶意代码片段：
{CODE}

任务要求：
1. 结合文本上下文，详细解释该代码片段的功能、恶意行为、攻击手法或技术细节；
2. 语言通顺，逻辑清晰，重点突出其恶意性质；
3. 直接输出描述内容，无需添加任何开场白或结束语。
"""